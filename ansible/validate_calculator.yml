---
- name: Validate Calculator
  hosts: app_servers
  gather_facts: yes
  tasks:

    - name: Run calculator container with sample input
      shell: |
        printf "3\n12\n5\n" | docker exec -i calculator /app/calculator
      register: calc_output
      ignore_errors: yes

    - name: Print calculator output
      debug:
        msg: "{{ calc_output.stdout }}"

    - name: Check for expected output (ln(12))
      assert:
        that:
          - "'ln(12) =' in calc_output.stdout"
        fail_msg: "Calculator output did not contain expected result!"
        success_msg: "Calculator ran successfully and returned expected output."
